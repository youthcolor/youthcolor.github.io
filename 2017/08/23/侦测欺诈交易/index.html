<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="youthcolor's blog"><title>侦测欺诈交易 | Geekdreams</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">侦测欺诈交易</h1><a id="logo" href="/.">Geekdreams</a><p class="description">Nothing is difficult to the man who will try.</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">侦测欺诈交易</h1><div class="post-meta"><a href="/2017/08/23/侦测欺诈交易/#comments" class="comment-count"><a id="uyan_count_unit" href="/2017/08/23/侦测欺诈交易/"></a>留言</a><p><span class="date">Aug 23, 2017</span><span><a href="/categories/R/" class="category">R</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><p>本案例来自葡萄牙作者Luis Torgo所著的《数据挖掘与Ｒ语言》一书第４章：侦测欺诈交易。</p>
<p>本章介绍了一类数据挖掘问题：离群值排序。特别是采用了一个从不同的方面处理这个任务的数据集。即应用了有监督的、无监督的和半监督的方法。对于应用有限的资源来找到一个现象的异常观测值这一常见问题，本章的应用可以看做是它的一个实例。多个实际问题可以映射到这个通用框架中，例如信用卡、电信和税收的欺诈侦测等。在证券领域，也有这种欺诈侦测一般概念的多个应用。</p>
<a id="more"></a>
<h2 id="加载数据"><a href="#加载数据" class="headerlink" title="加载数据"></a>加载数据</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 侦测欺骗交易</span></div><div class="line">setwd(<span class="string">"~/Downloads"</span>)</div><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Loading the data into R</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">load(<span class="string">'sales.Rdata'</span>)</div><div class="line"><span class="keyword">library</span>(DMwR)</div><div class="line">data(sales)</div><div class="line">head(sales)</div></pre></td></tr></table></figure>
<h2 id="探索数据集"><a href="#探索数据集" class="headerlink" title="探索数据集"></a>探索数据集</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Exploring the dataset</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">summary(sales)</div><div class="line">nlevels(sales$ID)</div><div class="line">nlevels(sales$Prod)</div><div class="line">length(which(is.na(sales$Quant) &amp; is.na(sales$Val)))</div><div class="line">sum(is.na(sales$Quant) &amp; is.na(sales$Val))</div><div class="line">table(sales$Insp)/nrow(sales)*<span class="number">100</span></div><div class="line">totS &lt;- table(sales$ID)</div><div class="line">totP &lt;- table(sales$Prod)</div><div class="line">barplot(totS,main=<span class="string">'Transactions per salespeople'</span>,names.arg=<span class="string">''</span>,xlab=<span class="string">'Salespeople'</span>,</div><div class="line">        ylab=<span class="string">'Amount'</span>)</div></pre></td></tr></table></figure>
<p><img src="http://wx4.sinaimg.cn/mw690/e621a9abgy1fiskqh3tsqj20gx09kjrb.jpg" alt="image"><br><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">barplot(totP,main=<span class="string">'Transactions per product'</span>,names.arg=<span class="string">''</span>,xlab=<span class="string">'Products'</span>,</div><div class="line">        ylab=<span class="string">'Amount'</span>)</div></pre></td></tr></table></figure></p>
<p><img src="http://wx2.sinaimg.cn/mw690/e621a9abgy1fiskqhla0aj20gx09kjrd.jpg" alt="image"><br><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">sales$Uprice &lt;- sales$Val/sales$Quant</div><div class="line">summary(sales$Uprice)</div><div class="line"><span class="keyword">attach</span>(sales)</div><div class="line">upp &lt;- aggregate(Uprice,list(Prod),median,na.rm=<span class="literal">T</span>)</div><div class="line">topP &lt;- sapply(c(<span class="literal">T</span>,<span class="literal">F</span>),<span class="keyword">function</span>(o) </div><div class="line">  upp[order(upp[,<span class="number">2</span>],decreasing=o)[<span class="number">1</span>:<span class="number">5</span>],<span class="number">1</span>])</div><div class="line">colnames(topP) &lt;- c(<span class="string">'Expensive'</span>,<span class="string">'Cheap'</span>)</div><div class="line">topP</div><div class="line">tops &lt;- sales[Prod %<span class="keyword">in</span>% topP[<span class="number">1</span>,],c(<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>)]</div><div class="line">tops$Prod &lt;- factor(tops$Prod)</div><div class="line">boxplot(Uprice ~ Prod,data=tops,ylab=<span class="string">'Uprice'</span>,log=<span class="string">"y"</span>)</div></pre></td></tr></table></figure></p>
<p><img src="http://wx1.sinaimg.cn/mw690/e621a9abgy1fiskqi2syfj20gx0c3749.jpg" alt="image"><br><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">vs &lt;- aggregate(Val,list(ID),sum,na.rm=<span class="literal">T</span>)</div><div class="line">scoresSs &lt;- sapply(c(<span class="literal">T</span>,<span class="literal">F</span>),<span class="keyword">function</span>(o) </div><div class="line">  vs[order(vs$x,decreasing=o)[<span class="number">1</span>:<span class="number">5</span>],<span class="number">1</span>])</div><div class="line">colnames(scoresSs) &lt;- c(<span class="string">'Most'</span>,<span class="string">'Least'</span>)</div><div class="line">scoresSs</div><div class="line">sum(vs[order(vs$x,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">100</span>],<span class="number">2</span>])/sum(Val,na.rm=<span class="literal">T</span>)*<span class="number">100</span></div><div class="line">sum(vs[order(vs$x,decreasing=<span class="literal">F</span>)[<span class="number">1</span>:<span class="number">2000</span>],<span class="number">2</span>])/sum(Val,na.rm=<span class="literal">T</span>)*<span class="number">100</span></div><div class="line">qs &lt;- aggregate(Quant,list(Prod),sum,na.rm=<span class="literal">T</span>)</div><div class="line">scoresPs &lt;- sapply(c(<span class="literal">T</span>,<span class="literal">F</span>),<span class="keyword">function</span>(o) </div><div class="line">  qs[order(qs$x,decreasing=o)[<span class="number">1</span>:<span class="number">5</span>],<span class="number">1</span>])</div><div class="line">colnames(scoresPs) &lt;- c(<span class="string">'Most'</span>,<span class="string">'Least'</span>)</div><div class="line">scoresPs</div><div class="line">sum(as.double(qs[order(qs$x,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">100</span>],<span class="number">2</span>]))/</div><div class="line">  sum(as.double(Quant),na.rm=<span class="literal">T</span>)*<span class="number">100</span></div><div class="line">sum(as.double(qs[order(qs$x,decreasing=<span class="literal">F</span>)[<span class="number">1</span>:<span class="number">4000</span>],<span class="number">2</span>]))/</div><div class="line">  sum(as.double(Quant),na.rm=<span class="literal">T</span>)*<span class="number">100</span></div><div class="line">out &lt;- tapply(Uprice,list(Prod=Prod),</div><div class="line">              <span class="keyword">function</span>(x) length(boxplot.stats(x)$out))</div><div class="line">out[order(out,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">10</span>]]</div><div class="line">sum(out)</div><div class="line">sum(out)/nrow(sales)*<span class="number">100</span></div></pre></td></tr></table></figure></p>
<h2 id="数据问题"><a href="#数据问题" class="headerlink" title="数据问题"></a>数据问题</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Data problems</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">totS &lt;- table(ID)</div><div class="line">totP &lt;- table(Prod)</div><div class="line">nas &lt;- sales[which(is.na(Quant) &amp; is.na(Val)),c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>)]</div><div class="line">propS &lt;- <span class="number">100</span>*table(nas$ID)/totS</div><div class="line">propS[order(propS,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">10</span>]]</div><div class="line">propP &lt;- <span class="number">100</span>*table(nas$Prod)/totP</div><div class="line">propP[order(propP,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">10</span>]]</div><div class="line"><span class="keyword">detach</span>(sales)</div><div class="line">sales &lt;- sales[-which(is.na(sales$Quant) &amp; is.na(sales$Val)),]</div><div class="line">nnasQp &lt;- tapply(sales$Quant,list(sales$Prod),</div><div class="line">                 <span class="keyword">function</span>(x) sum(is.na(x)))</div><div class="line">propNAsQp &lt;- nnasQp/table(sales$Prod)</div><div class="line">propNAsQp[order(propNAsQp,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">10</span>]]</div><div class="line">sales &lt;- sales[!sales$Prod %<span class="keyword">in</span>% c(<span class="string">'p2442'</span>,<span class="string">'p2443'</span>),]</div><div class="line">nlevels(sales$Prod)</div><div class="line">sales$Prod &lt;- factor(sales$Prod)</div><div class="line">nlevels(sales$Prod)</div><div class="line">nnasQs &lt;- tapply(sales$Quant,list(sales$ID),<span class="keyword">function</span>(x) sum(is.na(x)))</div><div class="line">propNAsQs &lt;- nnasQs/table(sales$ID)</div><div class="line">propNAsQs[order(propNAsQs,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">10</span>]]</div><div class="line">nnasVp &lt;- tapply(sales$Val,list(sales$Prod),</div><div class="line">                 <span class="keyword">function</span>(x) sum(is.na(x)))</div><div class="line">propNAsVp &lt;- nnasVp/table(sales$Prod)</div><div class="line">propNAsVp[order(propNAsVp,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">10</span>]]</div><div class="line">nnasVs &lt;- tapply(sales$Val,list(sales$ID),<span class="keyword">function</span>(x) sum(is.na(x)))</div><div class="line">propNAsVs &lt;- nnasVs/table(sales$ID)</div><div class="line">propNAsVs[order(propNAsVs,decreasing=<span class="literal">T</span>)[<span class="number">1</span>:<span class="number">10</span>]]</div><div class="line">tPrice &lt;- tapply(sales[sales$Insp != <span class="string">'fraud'</span>,<span class="string">'Uprice'</span>],</div><div class="line">                 list(sales[sales$Insp != <span class="string">'fraud'</span>,<span class="string">'Prod'</span>]),</div><div class="line">                 median,na.rm=<span class="literal">T</span>)</div><div class="line">noQuant &lt;- which(is.na(sales$Quant))</div><div class="line">sales[noQuant,<span class="string">'Quant'</span>] &lt;- ceiling(sales[noQuant,<span class="string">'Val'</span>] /</div><div class="line">                                    tPrice[sales[noQuant,<span class="string">'Prod'</span>]])</div><div class="line">noVal &lt;- which(is.na(sales$Val))</div><div class="line">sales[noVal,<span class="string">'Val'</span>] &lt;- sales[noVal,<span class="string">'Quant'</span>] *</div><div class="line">  tPrice[sales[noVal,<span class="string">'Prod'</span>]]</div><div class="line">sales$Uprice &lt;- sales$Val/sales$Quant</div><div class="line">save(sales,file=<span class="string">'salesClean.Rdata'</span>)</div><div class="line"><span class="keyword">attach</span>(sales)</div><div class="line">notF &lt;- which(Insp != <span class="string">'fraud'</span>)</div><div class="line">ms &lt;- tapply(Uprice[notF],list(Prod=Prod[notF]),<span class="keyword">function</span>(x) &#123;</div><div class="line">  bp &lt;- boxplot.stats(x)$stats</div><div class="line">  c(median=bp[<span class="number">3</span>],iqr=bp[<span class="number">4</span>]-bp[<span class="number">2</span>])</div><div class="line">&#125;)</div><div class="line">ms &lt;- matrix(unlist(ms),</div><div class="line">             length(ms),<span class="number">2</span>,</div><div class="line">             byrow=<span class="literal">T</span>,dimnames=list(names(ms),c(<span class="string">'median'</span>,<span class="string">'iqr'</span>)))</div><div class="line">head(ms)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">plot(ms[,<span class="number">1</span>],ms[,<span class="number">2</span>],xlab=<span class="string">'Median'</span>,ylab=<span class="string">'IQR'</span>,main=<span class="string">''</span>)</div><div class="line">plot(ms[,<span class="number">1</span>],ms[,<span class="number">2</span>],xlab=<span class="string">'Median'</span>,ylab=<span class="string">'IQR'</span>,main=<span class="string">''</span>,col=<span class="string">'grey'</span>,log=<span class="string">"xy"</span>)</div><div class="line">smalls &lt;- which(table(Prod) &lt; <span class="number">20</span>)</div><div class="line">points(log(ms[smalls,<span class="number">1</span>]),log(ms[smalls,<span class="number">2</span>]),pch=<span class="string">'+'</span>)</div></pre></td></tr></table></figure>
<p><img src="http://wx1.sinaimg.cn/mw690/e621a9abgy1fiskqio0tij20gx0c3dfy.jpg" alt="image"><br><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">dms &lt;- scale(ms)</div><div class="line">smalls &lt;- which(table(Prod) &lt; <span class="number">20</span>)</div><div class="line">prods &lt;- tapply(sales$Uprice,sales$Prod,list)</div><div class="line">similar &lt;- matrix(<span class="literal">NA</span>,length(smalls),<span class="number">7</span>,dimnames=list(names(smalls),</div><div class="line">                                                    c(<span class="string">'Simil'</span>,<span class="string">'ks.stat'</span>,<span class="string">'ks.p'</span>,<span class="string">'medP'</span>,<span class="string">'iqrP'</span>,<span class="string">'medS'</span>,<span class="string">'iqrS'</span>)))</div><div class="line"></div><div class="line"><span class="keyword">for</span>(i <span class="keyword">in</span> seq(along=smalls)) &#123;</div><div class="line">  d &lt;- scale(dms,dms[smalls[i],],<span class="literal">FALSE</span>)</div><div class="line">  d &lt;- sqrt(drop(d^<span class="number">2</span> %*% rep(<span class="number">1</span>,ncol(d))))</div><div class="line">  stat &lt;- ks.test(prods[[smalls[i]]],prods[[order(d)[<span class="number">2</span>]]])</div><div class="line">  similar[i,] &lt;- c(order(d)[<span class="number">2</span>],stat$statistic,stat$p.value,ms[smalls[i],],</div><div class="line">                   ms[order(d)[<span class="number">2</span>],])</div><div class="line">&#125;</div><div class="line">head(similar)</div><div class="line">levels(Prod)[similar[<span class="number">1</span>,<span class="number">1</span>]]</div><div class="line">nrow(similar[similar[,<span class="string">'ks.p'</span>] &gt;= <span class="number">0.9</span>,])</div><div class="line">sum(similar[,<span class="string">'ks.p'</span>] &gt;= <span class="number">0.9</span>)</div><div class="line">save(similar,file=<span class="string">'similarProducts.Rdata'</span>)</div></pre></td></tr></table></figure></p>
<h2 id="测试标准"><a href="#测试标准" class="headerlink" title="测试标准"></a>测试标准</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Evaluation criteria</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="keyword">library</span>(ROCR)</div><div class="line">data(ROCR.simple)</div><div class="line">pred &lt;- prediction( ROCR.simple$predictions, ROCR.simple$labels )</div><div class="line">perf &lt;- performance(pred,<span class="string">'prec'</span>,<span class="string">'rec'</span>)</div><div class="line">plot(perf)</div><div class="line">PRcurve &lt;- <span class="keyword">function</span>(preds,trues,<span class="keyword">...</span>) &#123;</div><div class="line">  <span class="keyword">require</span>(ROCR,quietly=<span class="literal">T</span>)</div><div class="line">  pd &lt;- prediction(preds,trues)</div><div class="line">  pf &lt;- performance(pd,<span class="string">'prec'</span>,<span class="string">'rec'</span>)</div><div class="line">  pf@y.values &lt;- lapply(pf@y.values,<span class="keyword">function</span>(x) rev(cummax(rev(x))))</div><div class="line">  plot(pf,<span class="keyword">...</span>)</div><div class="line">&#125;</div><div class="line">PRcurve(ROCR.simple$predictions, ROCR.simple$labels )</div></pre></td></tr></table></figure>
<p><img src="http://wx2.sinaimg.cn/mw690/e621a9abgy1fiskqopamzj20m80dzaa2.jpg" alt="image"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">pred &lt;- prediction( ROCR.simple$predictions, ROCR.simple$labels )</div><div class="line">perf &lt;- performance(pred,<span class="string">'lift'</span>,<span class="string">'rpp'</span>)</div><div class="line">plot(perf,main=<span class="string">'Lift Chart'</span>)</div><div class="line">CRchart &lt;- <span class="keyword">function</span>(preds,trues,<span class="keyword">...</span>) &#123;</div><div class="line">  <span class="keyword">require</span>(ROCR,quietly=<span class="literal">T</span>)</div><div class="line">  pd &lt;- prediction(preds,trues)</div><div class="line">  pf &lt;- performance(pd,<span class="string">'rec'</span>,<span class="string">'rpp'</span>)</div><div class="line">  plot(pf,<span class="keyword">...</span>)</div><div class="line">&#125;  </div><div class="line">CRchart(ROCR.simple$predictions, ROCR.simple$labels, </div><div class="line">        main=<span class="string">'Cumulative Recall Chart'</span>)</div></pre></td></tr></table></figure>
<p><img src="http://wx1.sinaimg.cn/mw690/e621a9abgy1fiskqpbb4dj20m80dzglr.jpg" alt="image"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">avgNDTP &lt;- <span class="keyword">function</span>(toInsp,train,stats) &#123;</div><div class="line">  <span class="keyword">if</span> (missing(train) &amp;&amp; missing(stats)) </div><div class="line">    <span class="keyword">stop</span>(<span class="string">'Provide either the training data or the product stats'</span>)</div><div class="line">  <span class="keyword">if</span> (missing(stats)) &#123;</div><div class="line">    notF &lt;- which(train$Insp != <span class="string">'fraud'</span>)</div><div class="line">    stats &lt;- tapply(train$Uprice[notF],</div><div class="line">                    list(Prod=train$Prod[notF]),</div><div class="line">                    <span class="keyword">function</span>(x) &#123;</div><div class="line">                      bp &lt;- boxplot.stats(x)$stats</div><div class="line">                      c(median=bp[<span class="number">3</span>],iqr=bp[<span class="number">4</span>]-bp[<span class="number">2</span>])</div><div class="line">                    &#125;)</div><div class="line">    stats &lt;- matrix(unlist(stats),</div><div class="line">                    length(stats),<span class="number">2</span>,byrow=<span class="literal">T</span>,</div><div class="line">                    dimnames=list(names(stats),c(<span class="string">'median'</span>,<span class="string">'iqr'</span>)))</div><div class="line">    stats[which(stats[,<span class="string">'iqr'</span>]==<span class="number">0</span>),<span class="string">'iqr'</span>] &lt;- </div><div class="line">      stats[which(stats[,<span class="string">'iqr'</span>]==<span class="number">0</span>),<span class="string">'median'</span>]</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  mdtp &lt;- mean(abs(toInsp$Uprice-stats[toInsp$Prod,<span class="string">'median'</span>]) /</div><div class="line">                 stats[toInsp$Prod,<span class="string">'iqr'</span>])</div><div class="line">  <span class="keyword">return</span>(mdtp)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="实验方法"><a href="#实验方法" class="headerlink" title="实验方法"></a>实验方法</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Experimental Methodology</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">evalOutlierRanking &lt;- <span class="keyword">function</span>(testSet,rankOrder,Threshold,statsProds) &#123;</div><div class="line">  ordTS &lt;- testSet[rankOrder,]</div><div class="line">  N &lt;- nrow(testSet)</div><div class="line">  nF &lt;- <span class="keyword">if</span> (Threshold &lt; <span class="number">1</span>) as.integer(Threshold*N) <span class="keyword">else</span> Threshold</div><div class="line">  cm &lt;- table(c(rep(<span class="string">'fraud'</span>,nF),rep(<span class="string">'ok'</span>,N-nF)),ordTS$Insp)</div><div class="line">  prec &lt;- cm[<span class="string">'fraud'</span>,<span class="string">'fraud'</span>]/sum(cm[<span class="string">'fraud'</span>,])</div><div class="line">  rec &lt;- cm[<span class="string">'fraud'</span>,<span class="string">'fraud'</span>]/sum(cm[,<span class="string">'fraud'</span>])</div><div class="line">  AVGndtp &lt;- avgNDTP(ordTS[nF,],stats=statsProds)</div><div class="line">  <span class="keyword">return</span>(c(Precision=prec,Recall=rec,avgNDTP=AVGndtp))</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="修改的箱图规则"><a href="#修改的箱图规则" class="headerlink" title="修改的箱图规则"></a>修改的箱图规则</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### The modified box plot rule</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">BPrule &lt;- <span class="keyword">function</span>(train,test) &#123;</div><div class="line">  notF &lt;- which(train$Insp != <span class="string">'fraud'</span>)</div><div class="line">  ms &lt;- tapply(train$Uprice[notF],list(Prod=train$Prod[notF]),</div><div class="line">               <span class="keyword">function</span>(x) &#123;</div><div class="line">                 bp &lt;- boxplot.stats(x)$stats</div><div class="line">                 c(median=bp[<span class="number">3</span>],iqr=bp[<span class="number">4</span>]-bp[<span class="number">2</span>])</div><div class="line">               &#125;)</div><div class="line">  ms &lt;- matrix(unlist(ms),length(ms),<span class="number">2</span>,byrow=<span class="literal">T</span>,</div><div class="line">               dimnames=list(names(ms),c(<span class="string">'median'</span>,<span class="string">'iqr'</span>)))</div><div class="line">  ms[which(ms[,<span class="string">'iqr'</span>]==<span class="number">0</span>),<span class="string">'iqr'</span>] &lt;- ms[which(ms[,<span class="string">'iqr'</span>]==<span class="number">0</span>),<span class="string">'median'</span>]</div><div class="line">  ORscore &lt;- abs(test$Uprice-ms[test$Prod,<span class="string">'median'</span>]) /</div><div class="line">    ms[test$Prod,<span class="string">'iqr'</span>]</div><div class="line">  <span class="keyword">return</span>(list(rankOrder=order(ORscore,decreasing=<span class="literal">T</span>),</div><div class="line">              rankScore=ORscore))</div><div class="line">&#125;</div><div class="line">notF &lt;- which(sales$Insp != <span class="string">'fraud'</span>)</div><div class="line">globalStats &lt;- tapply(sales$Uprice[notF],</div><div class="line">                      list(Prod=sales$Prod[notF]),</div><div class="line">                      <span class="keyword">function</span>(x) &#123;</div><div class="line">                        bp &lt;- boxplot.stats(x)$stats</div><div class="line">                        c(median=bp[<span class="number">3</span>],iqr=bp[<span class="number">4</span>]-bp[<span class="number">2</span>])</div><div class="line">                      &#125;)</div><div class="line">globalStats &lt;- matrix(unlist(globalStats),</div><div class="line">                      length(globalStats),<span class="number">2</span>,byrow=<span class="literal">T</span>,</div><div class="line">                      dimnames=list(names(globalStats),c(<span class="string">'median'</span>,<span class="string">'iqr'</span>)))</div><div class="line">globalStats[which(globalStats[,<span class="string">'iqr'</span>]==<span class="number">0</span>),<span class="string">'iqr'</span>] &lt;- </div><div class="line">  globalStats[which(globalStats[,<span class="string">'iqr'</span>]==<span class="number">0</span>),<span class="string">'median'</span>]</div><div class="line">ho.BPrule &lt;- <span class="keyword">function</span>(form, train, test, <span class="keyword">...</span>) &#123;</div><div class="line">  res &lt;- BPrule(train,test)</div><div class="line">  structure(evalOutlierRanking(test,res$rankOrder,<span class="keyword">...</span>),</div><div class="line">            itInfo=list(preds=res$rankScore,</div><div class="line">                        trues=ifelse(test$Insp==<span class="string">'fraud'</span>,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">            )</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">bp.res &lt;- holdOut(learner(<span class="string">'ho.BPrule'</span>,</div><div class="line">                          pars=list(Threshold=<span class="number">0.1</span>,</div><div class="line">                                    statsProds=globalStats)),</div><div class="line">                  dataset(Insp ~ .,sales),</div><div class="line">                  hldSettings(<span class="number">3</span>,<span class="number">0.3</span>,<span class="number">1234</span>,<span class="literal">T</span>),</div><div class="line">                  itsInfo=<span class="literal">TRUE</span></div><div class="line">)</div><div class="line">summary(bp.res)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">info &lt;- attr(bp.res,<span class="string">'itsInfo'</span>)</div><div class="line">PTs.bp &lt;- aperm(array(unlist(info),dim=c(length(info[[<span class="number">1</span>]]),<span class="number">2</span>,<span class="number">3</span>)),</div><div class="line">                c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">)</div><div class="line">PRcurve(PTs.bp[,,<span class="number">1</span>],PTs.bp[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.bp[,,<span class="number">1</span>],PTs.bp[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'Cumulative Recall curve'</span>,avg=<span class="string">'vertical'</span>)</div></pre></td></tr></table></figure>
<p><img src="http://wx2.sinaimg.cn/mw690/e621a9abgy1fiskqjbi7nj20m80g0glr.jpg" alt="image"></p>
<h2 id="局部离群值因子"><a href="#局部离群值因子" class="headerlink" title="局部离群值因子"></a>局部离群值因子</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Local outlier factors (LOF)</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">ho.LOF &lt;- <span class="keyword">function</span>(form, train, test, k, <span class="keyword">...</span>) &#123;</div><div class="line">  ntr &lt;- nrow(train)</div><div class="line">  all &lt;- rbind(train,test)</div><div class="line">  N &lt;- nrow(all)</div><div class="line">  ups &lt;- split(all$Uprice,all$Prod)</div><div class="line">  r &lt;- list(length=ups)</div><div class="line">  <span class="keyword">for</span>(u <span class="keyword">in</span> seq(along=ups)) </div><div class="line">    r[[u]] &lt;- <span class="keyword">if</span> (NROW(ups[[u]]) &gt; <span class="number">3</span>) </div><div class="line">      lofactor(ups[[u]],min(k,NROW(ups[[u]]) %/% <span class="number">2</span>)) </div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (NROW(ups[[u]])) rep(<span class="number">0</span>,NROW(ups[[u]])) </div><div class="line">  <span class="keyword">else</span> <span class="literal">NULL</span></div><div class="line">  all$lof &lt;- vector(length=N)</div><div class="line">  split(all$lof,all$Prod) &lt;- r</div><div class="line">  all$lof[which(!(is.infinite(all$lof) | is.nan(all$lof)))] &lt;- </div><div class="line">    SoftMax(all$lof[which(!(is.infinite(all$lof) | is.nan(all$lof)))])</div><div class="line">  structure(evalOutlierRanking(test,order(all[(ntr+<span class="number">1</span>):N,<span class="string">'lof'</span>],</div><div class="line">                                          decreasing=<span class="literal">T</span>),<span class="keyword">...</span>),</div><div class="line">            itInfo=list(preds=all[(ntr+<span class="number">1</span>):N,<span class="string">'lof'</span>],</div><div class="line">                        trues=ifelse(test$Insp==<span class="string">'fraud'</span>,<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">lof.res &lt;- holdOut(learner(<span class="string">'ho.LOF'</span>,</div><div class="line">                           pars=list(k=<span class="number">7</span>,Threshold=<span class="number">0.1</span>,</div><div class="line">                                     statsProds=globalStats)),</div><div class="line">                   dataset(Insp ~ .,sales),</div><div class="line">                   hldSettings(<span class="number">3</span>,<span class="number">0.3</span>,<span class="number">1234</span>,<span class="literal">T</span>),</div><div class="line">                   itsInfo=<span class="literal">TRUE</span></div><div class="line">)</div><div class="line">summary(lof.res)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">info &lt;- attr(lof.res,<span class="string">'itsInfo'</span>)</div><div class="line">PTs.lof &lt;- aperm(array(unlist(info),dim=c(length(info[[<span class="number">1</span>]]),<span class="number">2</span>,<span class="number">3</span>)),</div><div class="line">                 c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">)</div><div class="line">PRcurve(PTs.bp[,,<span class="number">1</span>],PTs.bp[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.lof[,,<span class="number">1</span>],PTs.lof[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">legend(<span class="string">'topright'</span>,c(<span class="string">'BPrule'</span>,<span class="string">'LOF'</span>),lty=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">CRchart(PTs.bp[,,<span class="number">1</span>],PTs.bp[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'Cumulative Recall curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.lof[,,<span class="number">1</span>],PTs.lof[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">legend(<span class="string">'bottomright'</span>,c(<span class="string">'BPrule'</span>,<span class="string">'LOF'</span>),lty=c(<span class="number">1</span>,<span class="number">2</span>))</div></pre></td></tr></table></figure>
<p><img src="http://wx2.sinaimg.cn/mw690/e621a9abgy1fiskqjq9tbj20m80g0weq.jpg" alt="image"></p>
<h2 id="基于聚类的离群值排名"><a href="#基于聚类的离群值排名" class="headerlink" title="基于聚类的离群值排名"></a>基于聚类的离群值排名</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Clustering-based outlier rankings (OR_h)</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">ho.ORh &lt;- <span class="keyword">function</span>(form, train, test, <span class="keyword">...</span>) &#123;</div><div class="line">  <span class="keyword">require</span>(dprep,quietly=<span class="literal">T</span>)</div><div class="line">  ntr &lt;- nrow(train)</div><div class="line">  all &lt;- rbind(train,test)</div><div class="line">  N &lt;- nrow(all)</div><div class="line">  ups &lt;- split(all$Uprice,all$Prod)</div><div class="line">  r &lt;- list(length=ups)</div><div class="line">  <span class="keyword">for</span>(u <span class="keyword">in</span> seq(along=ups)) </div><div class="line">    r[[u]] &lt;- <span class="keyword">if</span> (NROW(ups[[u]]) &gt; <span class="number">3</span>) </div><div class="line">      outliers.ranking(ups[[u]])$prob.outliers </div><div class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (NROW(ups[[u]])) rep(<span class="number">0</span>,NROW(ups[[u]])) </div><div class="line">  <span class="keyword">else</span> <span class="literal">NULL</span></div><div class="line">  all$lof &lt;- vector(length=N)</div><div class="line">  split(all$lof,all$Prod) &lt;- r</div><div class="line">  all$lof[which(!(is.infinite(all$lof) | is.nan(all$lof)))] &lt;- </div><div class="line">    SoftMax(all$lof[which(!(is.infinite(all$lof) | is.nan(all$lof)))])</div><div class="line">  structure(evalOutlierRanking(test,order(all[(ntr+<span class="number">1</span>):N,<span class="string">'lof'</span>],</div><div class="line">                                          decreasing=<span class="literal">T</span>),<span class="keyword">...</span>),</div><div class="line">            itInfo=list(preds=all[(ntr+<span class="number">1</span>):N,<span class="string">'lof'</span>],</div><div class="line">                        trues=ifelse(test$Insp==<span class="string">'fraud'</span>,<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">orh.res &lt;- holdOut(learner(<span class="string">'ho.ORh'</span>,</div><div class="line">                           pars=list(Threshold=<span class="number">0.1</span>,</div><div class="line">                                     statsProds=globalStats)),</div><div class="line">                   dataset(Insp ~ .,sales),</div><div class="line">                   hldSettings(<span class="number">3</span>,<span class="number">0.3</span>,<span class="number">1234</span>,<span class="literal">T</span>),</div><div class="line">                   itsInfo=<span class="literal">TRUE</span></div><div class="line">)</div><div class="line">summary(orh.res)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">info &lt;- attr(orh.res,<span class="string">'itsInfo'</span>)</div><div class="line">PTs.orh &lt;- aperm(array(unlist(info),dim=c(length(info[[<span class="number">1</span>]]),<span class="number">2</span>,<span class="number">3</span>)),</div><div class="line">                 c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">)</div><div class="line">PRcurve(PTs.bp[,,<span class="number">1</span>],PTs.bp[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.lof[,,<span class="number">1</span>],PTs.lof[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'topright'</span>,c(<span class="string">'BPrule'</span>,<span class="string">'LOF'</span>,<span class="string">'ORh'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>),col=c(<span class="string">'black'</span>,<span class="string">'black'</span>,<span class="string">'grey'</span>))</div><div class="line">CRchart(PTs.bp[,,<span class="number">1</span>],PTs.bp[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'Cumulative Recall curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.lof[,,<span class="number">1</span>],PTs.lof[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">legend(<span class="string">'bottomright'</span>,c(<span class="string">'BPrule'</span>,<span class="string">'LOF'</span>,<span class="string">'ORh'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>),col=c(<span class="string">'black'</span>,<span class="string">'black'</span>,<span class="string">'grey'</span>))</div></pre></td></tr></table></figure>
<p><img src="http://wx2.sinaimg.cn/mw690/e621a9abgy1fiskqkjbjrj20m80g03yt.jpg" alt="image"></p>
<h2 id="类失衡问题"><a href="#类失衡问题" class="headerlink" title="类失衡问题"></a>类失衡问题</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### The class imbalance problem</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">data(iris)</div><div class="line">data &lt;- iris[,c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">5</span>)]</div><div class="line">data$Species &lt;- factor(ifelse(data$Species == <span class="string">'setosa'</span>,<span class="string">'rare'</span>,<span class="string">'common'</span>))</div><div class="line">newData &lt;- SMOTE(Species ~ .,data,perc.over=<span class="number">600</span>)</div><div class="line">table(newData$Species)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">plot(data[,<span class="number">1</span>],data[,<span class="number">2</span>],pch=<span class="number">19</span>+as.integer(data[,<span class="number">3</span>]),main=<span class="string">'Original Data'</span>)</div><div class="line">plot(newData[,<span class="number">1</span>],newData[,<span class="number">2</span>],pch=<span class="number">19</span>+as.integer(newData[,<span class="number">3</span>]),main=<span class="string">"SMOTE'd Data"</span>)</div></pre></td></tr></table></figure>
<p><img src="http://wx3.sinaimg.cn/mw690/e621a9abgy1fiskqkx1s0j20m80g0aai.jpg" alt="image"></p>
<h2 id="简单贝叶斯方法"><a href="#简单贝叶斯方法" class="headerlink" title="简单贝叶斯方法"></a>简单贝叶斯方法</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Naive Bayes</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">nb &lt;- <span class="keyword">function</span>(train,test) &#123;</div><div class="line">  <span class="keyword">require</span>(e1071,quietly=<span class="literal">T</span>)</div><div class="line">  sup &lt;- which(train$Insp != <span class="string">'unkn'</span>)</div><div class="line">  data &lt;- train[sup,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)]</div><div class="line">  data$Insp &lt;- factor(data$Insp,levels=c(<span class="string">'ok'</span>,<span class="string">'fraud'</span>))</div><div class="line">  model &lt;- naiveBayes(Insp ~ .,data)</div><div class="line">  preds &lt;- predict(model,test[,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)],type=<span class="string">'raw'</span>)</div><div class="line">  <span class="keyword">return</span>(list(rankOrder=order(preds[,<span class="string">'fraud'</span>],decreasing=<span class="literal">T</span>),</div><div class="line">              rankScore=preds[,<span class="string">'fraud'</span>])</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">ho.nb &lt;- <span class="keyword">function</span>(form, train, test, <span class="keyword">...</span>) &#123;</div><div class="line">  res &lt;- nb(train,test)</div><div class="line">  structure(evalOutlierRanking(test,res$rankOrder,<span class="keyword">...</span>),</div><div class="line">            itInfo=list(preds=res$rankScore,</div><div class="line">                        trues=ifelse(test$Insp==<span class="string">'fraud'</span>,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">            )</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">nb.res &lt;- holdOut(learner(<span class="string">'ho.nb'</span>,</div><div class="line">                          pars=list(Threshold=<span class="number">0.1</span>,</div><div class="line">                                    statsProds=globalStats)),</div><div class="line">                  dataset(Insp ~ .,sales),</div><div class="line">                  hldSettings(<span class="number">3</span>,<span class="number">0.3</span>,<span class="number">1234</span>,<span class="literal">T</span>),</div><div class="line">                  itsInfo=<span class="literal">TRUE</span></div><div class="line">)</div><div class="line">summary(nb.res)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">info &lt;- attr(nb.res,<span class="string">'itsInfo'</span>)</div><div class="line">PTs.nb &lt;- aperm(array(unlist(info),dim=c(length(info[[<span class="number">1</span>]]),<span class="number">2</span>,<span class="number">3</span>)),</div><div class="line">                c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">)</div><div class="line">PRcurve(PTs.nb[,,<span class="number">1</span>],PTs.nb[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'topright'</span>,c(<span class="string">'NaiveBayes'</span>,<span class="string">'ORh'</span>),</div><div class="line">       lty=<span class="number">1</span>,col=c(<span class="string">'black'</span>,<span class="string">'grey'</span>))</div><div class="line">CRchart(PTs.nb[,,<span class="number">1</span>],PTs.nb[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'Cumulative Recall curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'bottomright'</span>,c(<span class="string">'NaiveBayes'</span>,<span class="string">'ORh'</span>),</div><div class="line">       lty=<span class="number">1</span>,col=c(<span class="string">'black'</span>,<span class="string">'grey'</span>))</div></pre></td></tr></table></figure>
<p><img src="http://wx2.sinaimg.cn/mw690/e621a9abgy1fiskqlig5ij20m80g074j.jpg" alt="image"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line">nb.s &lt;- <span class="keyword">function</span>(train,test) &#123;</div><div class="line">  <span class="keyword">require</span>(e1071,quietly=<span class="literal">T</span>)</div><div class="line">  sup &lt;- which(train$Insp != <span class="string">'unkn'</span>)</div><div class="line">  data &lt;- train[sup,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)]</div><div class="line">  data$Insp &lt;- factor(data$Insp,levels=c(<span class="string">'ok'</span>,<span class="string">'fraud'</span>))</div><div class="line">  newData &lt;- SMOTE(Insp ~ .,data,perc.over=<span class="number">700</span>)</div><div class="line">  model &lt;- naiveBayes(Insp ~ .,newData)</div><div class="line">  preds &lt;- predict(model,test[,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)],type=<span class="string">'raw'</span>)</div><div class="line">  <span class="keyword">return</span>(list(rankOrder=order(preds[,<span class="string">'fraud'</span>],decreasing=<span class="literal">T</span>),</div><div class="line">              rankScore=preds[,<span class="string">'fraud'</span>])</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">ho.nbs &lt;- <span class="keyword">function</span>(form, train, test, <span class="keyword">...</span>) &#123;</div><div class="line">  res &lt;- nb.s(train,test)</div><div class="line">  structure(evalOutlierRanking(test,res$rankOrder,<span class="keyword">...</span>),</div><div class="line">            itInfo=list(preds=res$rankScore,</div><div class="line">                        trues=ifelse(test$Insp==<span class="string">'fraud'</span>,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">            )</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">nbs.res &lt;- holdOut(learner(<span class="string">'ho.nbs'</span>,</div><div class="line">                           pars=list(Threshold=<span class="number">0.1</span>,</div><div class="line">                                     statsProds=globalStats)),</div><div class="line">                   dataset(Insp ~ .,sales),</div><div class="line">                   hldSettings(<span class="number">3</span>,<span class="number">0.3</span>,<span class="number">1234</span>,<span class="literal">T</span>),</div><div class="line">                   itsInfo=<span class="literal">TRUE</span></div><div class="line">)</div><div class="line">summary(nbs.res)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">info &lt;- attr(nbs.res,<span class="string">'itsInfo'</span>)</div><div class="line">PTs.nbs &lt;- aperm(array(unlist(info),dim=c(length(info[[<span class="number">1</span>]]),<span class="number">2</span>,<span class="number">3</span>)),</div><div class="line">                 c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">)</div><div class="line">PRcurve(PTs.nb[,,<span class="number">1</span>],PTs.nb[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.nbs[,,<span class="number">1</span>],PTs.nbs[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'topright'</span>,c(<span class="string">'NaiveBayes'</span>,<span class="string">'smoteNaiveBayes'</span>,<span class="string">'ORh'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>),col=c(<span class="string">'black'</span>,<span class="string">'black'</span>,<span class="string">'grey'</span>))</div><div class="line">CRchart(PTs.nb[,,<span class="number">1</span>],PTs.nb[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'Cumulative Recall curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.nbs[,,<span class="number">1</span>],PTs.nbs[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'bottomright'</span>,c(<span class="string">'NaiveBayes'</span>,<span class="string">'smoteNaiveBayes'</span>,<span class="string">'ORh'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>),col=c(<span class="string">'black'</span>,<span class="string">'black'</span>,<span class="string">'grey'</span>))</div></pre></td></tr></table></figure>
<p><img src="http://wx4.sinaimg.cn/mw690/e621a9abgy1fiskqlymwnj20m80dzq37.jpg" alt="image"></p>
<h2 id="AdaBoost方法"><a href="#AdaBoost方法" class="headerlink" title="AdaBoost方法"></a>AdaBoost方法</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### AdaBoost</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="keyword">library</span>(RWeka)</div><div class="line">WOW(AdaBoostM1)</div><div class="line">data(iris)</div><div class="line">idx &lt;- sample(<span class="number">150</span>,<span class="number">100</span>)</div><div class="line">model &lt;- AdaBoostM1(Species ~ .,iris[idx,],</div><div class="line">                    control=Weka_control(I=<span class="number">100</span>))</div><div class="line">preds &lt;- predict(model,iris[-idx,])</div><div class="line">head(preds)</div><div class="line">table(preds,iris[-idx,<span class="string">'Species'</span>])</div><div class="line">prob.preds &lt;- predict(model,iris[-idx,],type=<span class="string">'probability'</span>)</div><div class="line">head(prob.preds)</div><div class="line">ab &lt;- <span class="keyword">function</span>(train,test) &#123;</div><div class="line">  <span class="keyword">require</span>(RWeka,quietly=<span class="literal">T</span>)</div><div class="line">  sup &lt;- which(train$Insp != <span class="string">'unkn'</span>)</div><div class="line">  data &lt;- train[sup,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)]</div><div class="line">  data$Insp &lt;- factor(data$Insp,levels=c(<span class="string">'ok'</span>,<span class="string">'fraud'</span>))</div><div class="line">  model &lt;- AdaBoostM1(Insp ~ .,data,</div><div class="line">                      control=Weka_control(I=<span class="number">100</span>))</div><div class="line">  preds &lt;- predict(model,test[,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)],</div><div class="line">                   type=<span class="string">'probability'</span>)</div><div class="line">  <span class="keyword">return</span>(list(rankOrder=order(preds[,<span class="string">'fraud'</span>],decreasing=<span class="literal">T</span>),</div><div class="line">              rankScore=preds[,<span class="string">'fraud'</span>])</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">ho.ab &lt;- <span class="keyword">function</span>(form, train, test, <span class="keyword">...</span>) &#123;</div><div class="line">  res &lt;- ab(train,test)</div><div class="line">  structure(evalOutlierRanking(test,res$rankOrder,<span class="keyword">...</span>),</div><div class="line">            itInfo=list(preds=res$rankScore,</div><div class="line">                        trues=ifelse(test$Insp==<span class="string">'fraud'</span>,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">            )</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">ab.res &lt;- holdOut(learner(<span class="string">'ho.ab'</span>,</div><div class="line">                          pars=list(Threshold=<span class="number">0.1</span>,</div><div class="line">                                    statsProds=globalStats)),</div><div class="line">                  dataset(Insp ~ .,sales),</div><div class="line">                  hldSettings(<span class="number">3</span>,<span class="number">0.3</span>,<span class="number">1234</span>,<span class="literal">T</span>),</div><div class="line">                  itsInfo=<span class="literal">TRUE</span></div><div class="line">)</div><div class="line">summary(ab.res)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">info &lt;- attr(ab.res,<span class="string">'itsInfo'</span>)</div><div class="line">PTs.ab &lt;- aperm(array(unlist(info),dim=c(length(info[[<span class="number">1</span>]]),<span class="number">2</span>,<span class="number">3</span>)),</div><div class="line">                c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">)</div><div class="line">PRcurve(PTs.nb[,,<span class="number">1</span>],PTs.nb[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">PRcurve(PTs.ab[,,<span class="number">1</span>],PTs.ab[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'topright'</span>,c(<span class="string">'NaiveBayes'</span>,<span class="string">'ORh'</span>,<span class="string">'AdaBoostM1'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>),col=c(<span class="string">'black'</span>,<span class="string">'grey'</span>,<span class="string">'black'</span>))</div><div class="line">CRchart(PTs.nb[,,<span class="number">1</span>],PTs.nb[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">CRchart(PTs.ab[,,<span class="number">1</span>],PTs.ab[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'bottomright'</span>,c(<span class="string">'NaiveBayes'</span>,<span class="string">'ORh'</span>,<span class="string">'AdaBoostM1'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>),col=c(<span class="string">'black'</span>,<span class="string">'grey'</span>,<span class="string">'black'</span>))</div></pre></td></tr></table></figure>
<p><img src="http://wx1.sinaimg.cn/mw690/e621a9abgy1fiskqmoicdj20m80dzjrn.jpg" alt="image"></p>
<h2 id="半监督方法"><a href="#半监督方法" class="headerlink" title="半监督方法"></a>半监督方法</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="comment">###################################################</span></div><div class="line"><span class="comment">### Semi-supervised approaches</span></div><div class="line"><span class="comment">###################################################</span></div><div class="line">set.seed(<span class="number">1234</span>) <span class="comment"># Just to ensrure you get the same results as in the book</span></div><div class="line"><span class="keyword">library</span>(DMwR)</div><div class="line"><span class="keyword">library</span>(e1071)</div><div class="line">data(iris)</div><div class="line">idx &lt;- sample(<span class="number">150</span>,<span class="number">100</span>)</div><div class="line">tr &lt;- iris[idx,]</div><div class="line">ts &lt;- iris[-idx,]</div><div class="line">nb &lt;- naiveBayes(Species ~ .,tr)</div><div class="line">table(predict(nb,ts),ts$Species)</div><div class="line">trST &lt;- tr</div><div class="line">nas &lt;- sample(<span class="number">100</span>,<span class="number">90</span>)</div><div class="line">trST[nas,<span class="string">'Species'</span>] &lt;- <span class="literal">NA</span></div><div class="line">func &lt;- <span class="keyword">function</span>(m,d) &#123;</div><div class="line">  p &lt;- predict(m,d,type=<span class="string">'raw'</span>)</div><div class="line">  data.frame(cl=colnames(p)[apply(p,<span class="number">1</span>,which.max)],p=apply(p,<span class="number">1</span>,max))</div><div class="line">&#125;</div><div class="line">nbSTbase &lt;- naiveBayes(Species ~ .,trST[-nas,])</div><div class="line">table(predict(nbSTbase,ts),ts$Species)</div><div class="line">nbST &lt;- SelfTrain(Species ~ .,trST,learner(<span class="string">'naiveBayes'</span>,list()),<span class="string">'func'</span>)</div><div class="line">table(predict(nbST,ts),ts$Species)</div><div class="line">pred.nb &lt;- <span class="keyword">function</span>(m,d) &#123;</div><div class="line">  p &lt;- predict(m,d,type=<span class="string">'raw'</span>)</div><div class="line">  data.frame(cl=colnames(p)[apply(p,<span class="number">1</span>,which.max)],</div><div class="line">             p=apply(p,<span class="number">1</span>,max)</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">nb.st &lt;- <span class="keyword">function</span>(train,test) &#123;</div><div class="line">  <span class="keyword">require</span>(e1071,quietly=<span class="literal">T</span>)</div><div class="line">  train &lt;- train[,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)]</div><div class="line">  train[which(train$Insp == <span class="string">'unkn'</span>),<span class="string">'Insp'</span>] &lt;- <span class="literal">NA</span></div><div class="line">  train$Insp &lt;- factor(train$Insp,levels=c(<span class="string">'ok'</span>,<span class="string">'fraud'</span>))</div><div class="line">  model &lt;- SelfTrain(Insp ~ .,train,</div><div class="line">                     learner(<span class="string">'naiveBayes'</span>,list()),<span class="string">'pred.nb'</span>)</div><div class="line">  preds &lt;- predict(model,test[,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)],</div><div class="line">                   type=<span class="string">'raw'</span>)</div><div class="line">  <span class="keyword">return</span>(list(rankOrder=order(preds[,<span class="string">'fraud'</span>],decreasing=<span class="literal">T</span>),</div><div class="line">              rankScore=preds[,<span class="string">'fraud'</span>])</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">ho.nb.st &lt;- <span class="keyword">function</span>(form, train, test, <span class="keyword">...</span>) &#123;</div><div class="line">  res &lt;- nb.st(train,test)</div><div class="line">  structure(evalOutlierRanking(test,res$rankOrder,<span class="keyword">...</span>),</div><div class="line">            itInfo=list(preds=res$rankScore,</div><div class="line">                        trues=ifelse(test$Insp==<span class="string">'fraud'</span>,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">            )</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">nb.st.res &lt;- holdOut(learner(<span class="string">'ho.nb.st'</span>,</div><div class="line">                             pars=list(Threshold=<span class="number">0.1</span>,</div><div class="line">                                       statsProds=globalStats)),</div><div class="line">                     dataset(Insp ~ .,sales),</div><div class="line">                     hldSettings(<span class="number">3</span>,<span class="number">0.3</span>,<span class="number">1234</span>,<span class="literal">T</span>),</div><div class="line">                     itsInfo=<span class="literal">TRUE</span></div><div class="line">)</div><div class="line">summary(nb.st.res)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">info &lt;- attr(nb.st.res,<span class="string">'itsInfo'</span>)</div><div class="line">PTs.nb.st &lt;- aperm(array(unlist(info),dim=c(length(info[[<span class="number">1</span>]]),<span class="number">2</span>,<span class="number">3</span>)),</div><div class="line">                   c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">)</div><div class="line">PRcurve(PTs.nb[,,<span class="number">1</span>],PTs.nb[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">PRcurve(PTs.nb.st[,,<span class="number">1</span>],PTs.nb.st[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'topright'</span>,c(<span class="string">'NaiveBayes'</span>,<span class="string">'ORh'</span>,<span class="string">'NaiveBayes-ST'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>),col=c(<span class="string">'black'</span>,<span class="string">'grey'</span>,<span class="string">'black'</span>))</div><div class="line">CRchart(PTs.nb[,,<span class="number">1</span>],PTs.nb[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'Cumulative Recall curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">CRchart(PTs.nb.st[,,<span class="number">1</span>],PTs.nb.st[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'bottomright'</span>,c(<span class="string">'NaiveBayes'</span>,<span class="string">'ORh'</span>,<span class="string">'NaiveBayes-ST'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>),col=c(<span class="string">'black'</span>,<span class="string">'grey'</span>,<span class="string">'black'</span>))</div></pre></td></tr></table></figure>
<p><img src="http://wx3.sinaimg.cn/mw690/e621a9abgy1fiskqnmuo1j20m80dzt90.jpg" alt="image"></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div></pre></td><td class="code"><pre><div class="line">pred.ada &lt;- <span class="keyword">function</span>(m,d) &#123;</div><div class="line">  p &lt;- predict(m,d,type=<span class="string">'probability'</span>)</div><div class="line">  data.frame(cl=colnames(p)[apply(p,<span class="number">1</span>,which.max)],</div><div class="line">             p=apply(p,<span class="number">1</span>,max)</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">ab.st &lt;- <span class="keyword">function</span>(train,test) &#123;</div><div class="line">  <span class="keyword">require</span>(RWeka,quietly=<span class="literal">T</span>)</div><div class="line">  train &lt;- train[,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)]</div><div class="line">  train[which(train$Insp == <span class="string">'unkn'</span>),<span class="string">'Insp'</span>] &lt;- <span class="literal">NA</span></div><div class="line">  train$Insp &lt;- factor(train$Insp,levels=c(<span class="string">'ok'</span>,<span class="string">'fraud'</span>))</div><div class="line">  model &lt;- SelfTrain(Insp ~ .,train,</div><div class="line">                     learner(<span class="string">'AdaBoostM1'</span>,</div><div class="line">                             list(control=Weka_control(I=<span class="number">100</span>))),</div><div class="line">                     <span class="string">'pred.ada'</span>)</div><div class="line">  preds &lt;- predict(model,test[,c(<span class="string">'ID'</span>,<span class="string">'Prod'</span>,<span class="string">'Uprice'</span>,<span class="string">'Insp'</span>)],</div><div class="line">                   type=<span class="string">'probability'</span>)</div><div class="line">  <span class="keyword">return</span>(list(rankOrder=order(preds[,<span class="string">'fraud'</span>],decreasing=<span class="literal">T</span>),</div><div class="line">              rankScore=preds[,<span class="string">'fraud'</span>])</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">ho.ab.st &lt;- <span class="keyword">function</span>(form, train, test, <span class="keyword">...</span>) &#123;</div><div class="line">  res &lt;- ab.st(train,test)</div><div class="line">  structure(evalOutlierRanking(test,res$rankOrder,<span class="keyword">...</span>),</div><div class="line">            itInfo=list(preds=res$rankScore,</div><div class="line">                        trues=ifelse(test$Insp==<span class="string">'fraud'</span>,<span class="number">1</span>,<span class="number">0</span>)</div><div class="line">            )</div><div class="line">  )</div><div class="line">&#125;</div><div class="line">ab.st.res &lt;- holdOut(learner(<span class="string">'ho.ab.st'</span>,</div><div class="line">                             pars=list(Threshold=<span class="number">0.1</span>,</div><div class="line">                                       statsProds=globalStats)),</div><div class="line">                     dataset(Insp ~ .,sales),</div><div class="line">                     hldSettings(<span class="number">3</span>,<span class="number">0.3</span>,<span class="number">1234</span>,<span class="literal">T</span>),</div><div class="line">                     itsInfo=<span class="literal">TRUE</span></div><div class="line">)</div><div class="line">summary(ab.st.res)</div><div class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">2</span>))</div><div class="line">info &lt;- attr(ab.st.res,<span class="string">'itsInfo'</span>)</div><div class="line">PTs.ab.st &lt;- aperm(array(unlist(info),dim=c(length(info[[<span class="number">1</span>]]),<span class="number">2</span>,<span class="number">3</span>)),</div><div class="line">                   c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</div><div class="line">)</div><div class="line">PRcurve(PTs.ab[,,<span class="number">1</span>],PTs.ab[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'PR curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">PRcurve(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">PRcurve(PTs.ab.st[,,<span class="number">1</span>],PTs.ab.st[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'topright'</span>,c(<span class="string">'AdaBoostM1'</span>,<span class="string">'ORh'</span>,<span class="string">'AdaBoostM1-ST'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>),col=c(<span class="string">'black'</span>,<span class="string">'grey'</span>,<span class="string">'black'</span>))</div><div class="line">CRchart(PTs.ab[,,<span class="number">1</span>],PTs.ab[,,<span class="number">2</span>],</div><div class="line">        main=<span class="string">'Cumulative Recall curve'</span>,lty=<span class="number">1</span>,xlim=c(<span class="number">0</span>,<span class="number">1</span>),ylim=c(<span class="number">0</span>,<span class="number">1</span>),</div><div class="line">        avg=<span class="string">'vertical'</span>)</div><div class="line">CRchart(PTs.orh[,,<span class="number">1</span>],PTs.orh[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">1</span>,col=<span class="string">'grey'</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">CRchart(PTs.ab.st[,,<span class="number">1</span>],PTs.ab.st[,,<span class="number">2</span>],</div><div class="line">        add=<span class="literal">T</span>,lty=<span class="number">2</span>,</div><div class="line">        avg=<span class="string">'vertical'</span>)        </div><div class="line">legend(<span class="string">'bottomright'</span>,c(<span class="string">'AdaBoostM1'</span>,<span class="string">'ORh'</span>,<span class="string">'AdaBoostM1-ST'</span>),</div><div class="line">       lty=c(<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>),col=c(<span class="string">'black'</span>,<span class="string">'grey'</span>,<span class="string">'black'</span>))</div></pre></td></tr></table></figure>
<p><img src="http://wx3.sinaimg.cn/mw690/e621a9abgy1fiskqofvsmj20m80dz0t0.jpg" alt="image"></p>
</div><div class="tags"><a href="/tags/聚类/">聚类</a><a href="/tags/欺诈侦测/">欺诈侦测</a><a href="/tags/半监督分类/">半监督分类</a><a href="/tags/类失衡/">类失衡</a><a href="/tags/贝叶斯分类器/">贝叶斯分类器</a><a href="/tags/AdaBoost分类器/">AdaBoost分类器</a><a href="/tags/决策精确度/">决策精确度</a><a href="/tags/回溯精确度/">回溯精确度</a><a href="/tags/交叉验证/">交叉验证</a><a href="/tags/离群值侦测排序/">离群值侦测排序</a></div><div class="post-share"><div class="jiathis_style"><span class="jiathis_txt">分享到：</span><a class="jiathis_button_tsina"></a><a class="jiathis_button_qzone"></a><a class="jiathis_button_weixin"></a><a class="jiathis_button_fb"></a><a class="jiathis_button_linkedin"></a><a class="jiathis_button_twitter"></a><a class="jiathis_button_ydnote"></a><a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis"></a><a class="jiathis_counter_style"></a></div></div><div class="post-nav"><a href="/2017/11/10/译：机器学习算法要点（附Python和R代码）/" class="pre">译：机器学习算法要点（附Python和R代码）</a><a href="/2017/08/18/购物篮关联规则分析/" class="next">购物篮关联规则分析</a></div><div id="comments"><div id="uyan_frame"></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#加载数据"><span class="toc-text">加载数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#探索数据集"><span class="toc-text">探索数据集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数据问题"><span class="toc-text">数据问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试标准"><span class="toc-text">测试标准</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#实验方法"><span class="toc-text">实验方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修改的箱图规则"><span class="toc-text">修改的箱图规则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#局部离群值因子"><span class="toc-text">局部离群值因子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#基于聚类的离群值排名"><span class="toc-text">基于聚类的离群值排名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#类失衡问题"><span class="toc-text">类失衡问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#简单贝叶斯方法"><span class="toc-text">简单贝叶斯方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AdaBoost方法"><span class="toc-text">AdaBoost方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#半监督方法"><span class="toc-text">半监督方法</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/11/10/译：机器学习算法要点（附Python和R代码）/">译：机器学习算法要点（附Python和R代码）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/23/侦测欺诈交易/">侦测欺诈交易</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/18/购物篮关联规则分析/">购物篮关联规则分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/01/R中如何对量化策略进行回测/">R中如何对量化策略进行回测</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/11/R机器学习之股票预测初探/">R机器学习之股票预测初探</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/07/11/R中的大数据分析/">R中的大数据分析</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/R/">R</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/R/">R</a><span class="category-list-count">5</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/离群值侦测排序/" style="font-size: 15px;">离群值侦测排序</a> <a href="/tags/量化金融/" style="font-size: 15px;">量化金融</a> <a href="/tags/股票预测/" style="font-size: 15px;">股票预测</a> <a href="/tags/机器学习/" style="font-size: 15px;">机器学习</a> <a href="/tags/特征选取/" style="font-size: 15px;">特征选取</a> <a href="/tags/大数据/" style="font-size: 15px;">大数据</a> <a href="/tags/聚类/" style="font-size: 15px;">聚类</a> <a href="/tags/线性回归/" style="font-size: 15px;">线性回归</a> <a href="/tags/欺诈侦测/" style="font-size: 15px;">欺诈侦测</a> <a href="/tags/半监督分类/" style="font-size: 15px;">半监督分类</a> <a href="/tags/类失衡/" style="font-size: 15px;">类失衡</a> <a href="/tags/贝叶斯分类器/" style="font-size: 15px;">贝叶斯分类器</a> <a href="/tags/AdaBoost分类器/" style="font-size: 15px;">AdaBoost分类器</a> <a href="/tags/决策精确度/" style="font-size: 15px;">决策精确度</a> <a href="/tags/回溯精确度/" style="font-size: 15px;">回溯精确度</a> <a href="/tags/交叉验证/" style="font-size: 15px;">交叉验证</a> <a href="/tags/回测/" style="font-size: 15px;">回测</a> <a href="/tags/逻辑回归/" style="font-size: 15px;">逻辑回归</a> <a href="/tags/决策树/" style="font-size: 15px;">决策树</a> <a href="/tags/支持向量机/" style="font-size: 15px;">支持向量机</a> <a href="/tags/朴素贝叶斯/" style="font-size: 15px;">朴素贝叶斯</a> <a href="/tags/最近邻（KNN）/" style="font-size: 15px;">最近邻（KNN）</a> <a href="/tags/K-均值/" style="font-size: 15px;">K-均值</a> <a href="/tags/随机森林/" style="font-size: 15px;">随机森林</a> <a href="/tags/降维算法/" style="font-size: 15px;">降维算法</a> <a href="/tags/梯度下降算法/" style="font-size: 15px;">梯度下降算法</a> <a href="/tags/GBM/" style="font-size: 15px;">GBM</a> <a href="/tags/XGBoost/" style="font-size: 15px;">XGBoost</a> <a href="/tags/LightGBM/" style="font-size: 15px;">LightGBM</a> <a href="/tags/CatBoost/" style="font-size: 15px;">CatBoost</a> <a href="/tags/购物篮/" style="font-size: 15px;">购物篮</a> <a href="/tags/关联规则/" style="font-size: 15px;">关联规则</a> <a href="/tags/推荐算法/" style="font-size: 15px;">推荐算法</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://weibo.com/youthcolor" title="Geekdreams" target="_blank">Geekdreams</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">youthcolor.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>var jiathis_config={
    data_track_clickback:true,
    summary:"",
    shortUrl:true,
    hideMore:false
}</script><script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script><script src="http://v2.uyan.cc/code/uyan.js?uid=2136627"></script></body></html>